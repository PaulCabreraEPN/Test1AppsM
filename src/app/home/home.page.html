<ion-header>
  <ion-toolbar>
    <ion-title>Formulario de Postulación</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <form #form="ngForm" (ngSubmit)="enviarFormulario()" novalidate>
    <!-- Nombre -->
    <ion-item>
      <ion-label position="floating">Nombre completo</ion-label>
      <ion-input [(ngModel)]="sender" name="sender" required></ion-input>
    </ion-item>
    <ion-text color="danger" *ngIf="form.submitted && !sender">
      <p>Este campo es obligatorio.</p>
    </ion-text>

    <!-- Edad -->
    <ion-item>
      <ion-label position="floating">Edad</ion-label>
      <ion-input type="number" [(ngModel)]="age" name="age" required min="16"></ion-input>
    </ion-item>
    <ion-text color="danger" *ngIf="form.submitted && (!age || age < 16)">
      <p>Debes tener al menos 16 años.</p>
    </ion-text>

    <!-- Carrera (combo box - popup) -->
    <ion-item>
      <ion-label>Carrera deseada</ion-label>
      <ion-select [(ngModel)]="course" name="course" placeholder="Seleccione una carrera" required>
        <ion-select-option value="Ingeniería de Sistemas">Ingeniería de Sistemas</ion-select-option>
        <ion-select-option value="Medicina">Medicina</ion-select-option>
        <ion-select-option value="Arquitectura">Arquitectura</ion-select-option>
        <ion-select-option value="Administración de Empresas">Administración de Empresas</ion-select-option>
        <ion-select-option value="Derecho">Derecho</ion-select-option>
        <ion-select-option value="Psicología">Psicología</ion-select-option>
        <ion-select-option value="Contabilidad">Contabilidad</ion-select-option>
      </ion-select>
    </ion-item>
    <ion-text color="danger" *ngIf="form.submitted && !course">
      <p>Debes seleccionar una carrera.</p>
    </ion-text>

    <!-- Correo -->
    <ion-item>
      <ion-label position="floating">Correo electrónico</ion-label>
      <ion-input type="email" [(ngModel)]="email" name="email" required email></ion-input>
    </ion-item>
    <ion-text color="danger" *ngIf="form.submitted && !email">
      <p>Ingresa un correo válido.</p>
    </ion-text>

    <!-- Ciudad (combo box - popup) -->
    <ion-item>
      <ion-label>Ciudad</ion-label>
      <ion-select [(ngModel)]="city" name="city" placeholder="Seleccione una ciudad" required>
        <ion-select-option value="Quito">Quito</ion-select-option>
        <ion-select-option value="Guayaquil">Guayaquil</ion-select-option>
        <ion-select-option value="Cuenca">Cuenca</ion-select-option>
        <ion-select-option value="Ambato">Ambato</ion-select-option>
        <ion-select-option value="Loja">Loja</ion-select-option>
        <ion-select-option value="Manta">Manta</ion-select-option>
        <ion-select-option value="Ibarra">Ibarra</ion-select-option>
      </ion-select>
    </ion-item>
    <ion-text color="danger" *ngIf="form.submitted && !city">
      <p>Debes seleccionar una ciudad.</p>
    </ion-text>

    <!-- Teléfono -->
    <ion-item>
      <ion-label position="floating">Teléfono</ion-label>
      <ion-input [(ngModel)]="phone" name="phone" required pattern="^[0-9]{7,10}$"></ion-input>
    </ion-item>
    <ion-text color="danger" *ngIf="form.submitted && !phone">
      <p>Ingresa un número de teléfono válido (7 a 10 dígitos).</p>
    </ion-text>

    <!-- Botón Enviar -->
    <ion-button 
      expand="full" 
      type="submit" 
      class="ion-margin-top" 
      [disabled]="form.invalid || form.pristine">
      Enviar
    </ion-button>
  </form>

  <!-- Lista de formularios enviados -->
  <ion-list class="ion-margin-top">
    <ion-list-header>
      <ion-label>Postulaciones registradas</ion-label>
    </ion-list-header>
    <ion-item *ngFor="let f of formularios">
      <ion-label>
        <h2>{{ f.sender }}</h2>
        <p>Carrera: {{ f.course }}</p>
        <p>Edad: {{ f.age }} | Ciudad: {{ f.city }}</p>
        <p>Email: {{ f.email }} | Tel: {{ f.phone }}</p>
        <p><i>{{ f.createdAt | date:'short' }}</i></p>
      </ion-label>
    </ion-item>
  </ion-list>
</ion-content>
